[10/20 16:50:18] detectron2 INFO: Rank of current process: 2. World size: 4
[10/20 16:50:19] detectron2 INFO: Environment info:
-------------------------------  ------------------------------------------------------------------------
sys.platform                     linux
Python                           3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
numpy                            1.22.4
detectron2                       0.6 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/detectron2
Compiler                         GCC 9.4
CUDA compiler                    CUDA 11.8
detectron2 arch flags            8.6
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          2.4.1 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0,1,2,3                      NVIDIA GeForce RTX 3090 (arch=8.6)
Driver version                   550.144.03
CUDA_HOME                        /data/hmp/CUDA/11.8
Pillow                           9.3.0
torchvision                      0.20.0 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/torchvision
torchvision arch flags           3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              4.12.0
-------------------------------  ------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

[10/20 16:50:19] detectron2 INFO: Command line arguments: Namespace(config_file='configs/semantic/eval.yaml', dist_url='tcp://127.0.0.1:50185', eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=[], resume=False)
[10/20 16:50:19] detectron2 INFO: Contents of args.config_file=configs/semantic/eval.yaml:
# python train_net.py --config-file configs/semantic/eval.yaml  --num-gpus 8 --eval-only

_BASE_: ./train_semantic_large.yaml
MODEL:
  WEIGHTS: out/semantic/MAFT_Plus/maftp_l.pth  # path to maftp_l.pth
  META_ARCHITECTURE: "MAFT_Plus"
  FC_CLIP:
    CLIP_MODEL_NAME: "convnext_large_d_320"  
    CLIP_PRETRAINED_WEIGHTS: "laion2b_s29b_b131k_ft_soup" 
    EMBED_DIM: 768
    GEOMETRIC_ENSEMBLE_ALPHA: -1.
    GEOMETRIC_ENSEMBLE_BETA: -1.

DATASETS:
  TEST: ("openvocab_pascal20_sem_seg_val", "openvocab_ade20k_full_sem_seg_val", 'openvocab_pascal_ctx459_sem_seg_val', 'openvocab_pascal_ctx59_sem_seg_val', 'openvocab_ade20k_panoptic_val') 
  # TEST: ("openvocab_ade20k_full_sem_seg_val",) #'openvocab_ade20k_panoptic_val',)

OUTPUT_DIR: ./out/semantic/evaluation

[10/20 16:50:39] detectron2.engine.defaults INFO: Model:
MAFT_Plus(
  (backbone): CLIP(
    (clip_model): CLIP(
      (visual): TimmModel(
        (trunk): ConvNeXt(
          (stem): Sequential(
            (0): Conv2d(3, 192, kernel_size=(4, 4), stride=(4, 4))
            (1): LayerNorm2d((192,), eps=1e-06, elementwise_affine=True)
          )
          (stages): Sequential(
            (0): ConvNeXtStage(
              (downsample): Identity()
              (blocks): Sequential(
                (0): ConvNeXtBlock(
                  (conv_dw): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
                  (norm): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=192, out_features=768, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=768, out_features=192, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): Identity()
                )
                (1): ConvNeXtBlock(
                  (conv_dw): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
                  (norm): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=192, out_features=768, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=768, out_features=192, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.003)
                )
                (2): ConvNeXtBlock(
                  (conv_dw): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
                  (norm): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=192, out_features=768, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=768, out_features=192, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.006)
                )
              )
            )
            (1): ConvNeXtStage(
              (downsample): Sequential(
                (0): LayerNorm2d((192,), eps=1e-06, elementwise_affine=True)
                (1): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
              )
              (blocks): Sequential(
                (0): ConvNeXtBlock(
                  (conv_dw): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
                  (norm): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=384, out_features=1536, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=1536, out_features=384, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.009)
                )
                (1): ConvNeXtBlock(
                  (conv_dw): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
                  (norm): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=384, out_features=1536, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=1536, out_features=384, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.011)
                )
                (2): ConvNeXtBlock(
                  (conv_dw): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
                  (norm): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=384, out_features=1536, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=1536, out_features=384, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.014)
                )
              )
            )
            (2): ConvNeXtStage(
              (downsample): Sequential(
                (0): LayerNorm2d((384,), eps=1e-06, elementwise_affine=True)
                (1): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
              )
              (blocks): Sequential(
                (0): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.017)
                )
                (1): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.020)
                )
                (2): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.023)
                )
                (3): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.026)
                )
                (4): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.029)
                )
                (5): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.031)
                )
                (6): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.034)
                )
                (7): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.037)
                )
                (8): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.040)
                )
                (9): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.043)
                )
                (10): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.046)
                )
                (11): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.049)
                )
                (12): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.051)
                )
                (13): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.054)
                )
                (14): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.057)
                )
                (15): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.060)
                )
                (16): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.063)
                )
                (17): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.066)
                )
                (18): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.069)
                )
                (19): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.071)
                )
                (20): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.074)
                )
                (21): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.077)
                )
                (22): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.080)
                )
                (23): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.083)
                )
                (24): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.086)
                )
                (25): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.089)
                )
                (26): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.091)
                )
              )
            )
            (3): ConvNeXtStage(
              (downsample): Sequential(
                (0): LayerNorm2d((768,), eps=1e-06, elementwise_affine=True)
                (1): Conv2d(768, 1536, kernel_size=(2, 2), stride=(2, 2))
              )
              (blocks): Sequential(
                (0): ConvNeXtBlock(
                  (conv_dw): Conv2d(1536, 1536, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=1536)
                  (norm): LayerNorm((1536,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.094)
                )
                (1): ConvNeXtBlock(
                  (conv_dw): Conv2d(1536, 1536, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=1536)
                  (norm): LayerNorm((1536,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.097)
                )
                (2): ConvNeXtBlock(
                  (conv_dw): Conv2d(1536, 1536, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=1536)
                  (norm): LayerNorm((1536,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.100)
                )
              )
            )
          )
          (norm_pre): Identity()
          (head): NormMlpClassifierHead(
            (global_pool): SelectAdaptivePool2d(pool_type=avg, flatten=Identity())
            (norm): LayerNorm2d((1536,), eps=1e-06, elementwise_affine=True)
            (flatten): Flatten(start_dim=1, end_dim=-1)
            (pre_logits): Identity()
            (drop): Dropout(p=0.0, inplace=False)
            (fc): Identity()
          )
        )
        (head): Sequential(
          (mlp): Mlp(
            (fc1): Linear(in_features=1536, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0.0, inplace=False)
            (norm): Identity()
            (fc2): Linear(in_features=1536, out_features=768, bias=False)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
      )
      (transformer): Transformer(
        (resblocks): ModuleList(
          (0-15): 16 x ResidualAttentionBlock(
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ls_1): Identity()
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): GELU(approximate='none')
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ls_2): Identity()
          )
        )
      )
      (token_embedding): Embedding(49408, 768)
      (ln_final): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
  (void_embedding): Embedding(1, 768)
)
[10/20 16:50:39] detectron2.checkpoint.detection_checkpoint INFO: [DetectionCheckpointer] Loading from out/semantic/MAFT_Plus/maftp_l.pth ...
[10/20 16:50:39] fvcore.common.checkpoint INFO: [Checkpointer] Loading from out/semantic/MAFT_Plus/maftp_l.pth ...
[10/20 16:50:39] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[10/20 16:50:39] detectron2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 16:50:39] detectron2.data.common INFO: Serializing 1449 elements to byte tensors and concatenating them all ...
[10/20 16:50:39] detectron2.data.common INFO: Serialized dataset takes 1.38 MiB
[10/20 16:50:39] detectron2.evaluation.evaluator INFO: Start inference on 362 batches
[10/20 16:50:49] detectron2.evaluation.evaluator INFO: Inference done 11/362. Dataloading: 0.0018 s/iter. Inference: 0.0912 s/iter. Eval: 0.0093 s/iter. Total: 0.1023 s/iter. ETA=0:00:35
[10/20 16:50:54] detectron2.evaluation.evaluator INFO: Inference done 60/362. Dataloading: 0.0024 s/iter. Inference: 0.0917 s/iter. Eval: 0.0087 s/iter. Total: 0.1029 s/iter. ETA=0:00:31
[10/20 16:51:00] detectron2.evaluation.evaluator INFO: Inference done 109/362. Dataloading: 0.0026 s/iter. Inference: 0.0915 s/iter. Eval: 0.0091 s/iter. Total: 0.1033 s/iter. ETA=0:00:26
[10/20 16:51:05] detectron2.evaluation.evaluator INFO: Inference done 159/362. Dataloading: 0.0027 s/iter. Inference: 0.0909 s/iter. Eval: 0.0092 s/iter. Total: 0.1028 s/iter. ETA=0:00:20
[10/20 16:51:10] detectron2.evaluation.evaluator INFO: Inference done 208/362. Dataloading: 0.0027 s/iter. Inference: 0.0908 s/iter. Eval: 0.0093 s/iter. Total: 0.1028 s/iter. ETA=0:00:15
[10/20 16:51:15] detectron2.evaluation.evaluator INFO: Inference done 258/362. Dataloading: 0.0027 s/iter. Inference: 0.0908 s/iter. Eval: 0.0091 s/iter. Total: 0.1027 s/iter. ETA=0:00:10
[10/20 16:51:20] detectron2.evaluation.evaluator INFO: Inference done 308/362. Dataloading: 0.0027 s/iter. Inference: 0.0905 s/iter. Eval: 0.0091 s/iter. Total: 0.1024 s/iter. ETA=0:00:05
[10/20 16:51:25] detectron2.evaluation.evaluator INFO: Inference done 358/362. Dataloading: 0.0027 s/iter. Inference: 0.0904 s/iter. Eval: 0.0091 s/iter. Total: 0.1022 s/iter. ETA=0:00:00
[10/20 16:51:29] detectron2.evaluation.evaluator INFO: Total inference time: 0:00:39.877675 (0.111702 s / iter per device, on 4 devices)
[10/20 16:51:29] detectron2.evaluation.evaluator INFO: Total inference pure compute time: 0:00:32 (0.090407 s / iter per device, on 4 devices)
[10/20 16:51:29] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[10/20 16:51:29] detectron2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 16:51:29] detectron2.data.common INFO: Serializing 2000 elements to byte tensors and concatenating them all ...
[10/20 16:51:29] detectron2.data.common INFO: Serialized dataset takes 27.14 MiB
[10/20 16:51:29] detectron2.evaluation.evaluator INFO: Start inference on 500 batches
[10/20 16:52:00] detectron2.evaluation.evaluator INFO: Inference done 1/500. Dataloading: 6.3355 s/iter. Inference: 24.0206 s/iter. Eval: 0.0448 s/iter. Total: 30.4034 s/iter. ETA=4:12:51
[10/20 16:52:05] detectron2.evaluation.evaluator INFO: Inference done 42/500. Dataloading: 0.0026 s/iter. Inference: 0.1039 s/iter. Eval: 0.0164 s/iter. Total: 0.1229 s/iter. ETA=0:00:56
[10/20 16:52:10] detectron2.evaluation.evaluator INFO: Inference done 84/500. Dataloading: 0.0027 s/iter. Inference: 0.1042 s/iter. Eval: 0.0153 s/iter. Total: 0.1222 s/iter. ETA=0:00:50
[10/20 16:52:15] detectron2.evaluation.evaluator INFO: Inference done 127/500. Dataloading: 0.0027 s/iter. Inference: 0.1025 s/iter. Eval: 0.0156 s/iter. Total: 0.1209 s/iter. ETA=0:00:45
[10/20 16:52:20] detectron2.evaluation.evaluator INFO: Inference done 169/500. Dataloading: 0.0028 s/iter. Inference: 0.1025 s/iter. Eval: 0.0156 s/iter. Total: 0.1210 s/iter. ETA=0:00:40
[10/20 16:52:25] detectron2.evaluation.evaluator INFO: Inference done 214/500. Dataloading: 0.0028 s/iter. Inference: 0.1013 s/iter. Eval: 0.0153 s/iter. Total: 0.1194 s/iter. ETA=0:00:34
[10/20 16:52:30] detectron2.evaluation.evaluator INFO: Inference done 258/500. Dataloading: 0.0028 s/iter. Inference: 0.1009 s/iter. Eval: 0.0149 s/iter. Total: 0.1187 s/iter. ETA=0:00:28
[10/20 16:52:35] detectron2.evaluation.evaluator INFO: Inference done 304/500. Dataloading: 0.0028 s/iter. Inference: 0.1001 s/iter. Eval: 0.0145 s/iter. Total: 0.1175 s/iter. ETA=0:00:23
[10/20 16:52:40] detectron2.evaluation.evaluator INFO: Inference done 346/500. Dataloading: 0.0028 s/iter. Inference: 0.1004 s/iter. Eval: 0.0145 s/iter. Total: 0.1177 s/iter. ETA=0:00:18
[10/20 16:52:45] detectron2.evaluation.evaluator INFO: Inference done 391/500. Dataloading: 0.0028 s/iter. Inference: 0.1000 s/iter. Eval: 0.0142 s/iter. Total: 0.1171 s/iter. ETA=0:00:12
[10/20 16:52:50] detectron2.evaluation.evaluator INFO: Inference done 437/500. Dataloading: 0.0028 s/iter. Inference: 0.0994 s/iter. Eval: 0.0141 s/iter. Total: 0.1163 s/iter. ETA=0:00:07
[10/20 16:52:56] detectron2.evaluation.evaluator INFO: Inference done 480/500. Dataloading: 0.0028 s/iter. Inference: 0.0996 s/iter. Eval: 0.0140 s/iter. Total: 0.1165 s/iter. ETA=0:00:02
[10/20 16:52:59] detectron2.evaluation.evaluator INFO: Total inference time: 0:00:58.831433 (0.118851 s / iter per device, on 4 devices)
[10/20 16:52:59] detectron2.evaluation.evaluator INFO: Total inference pure compute time: 0:00:49 (0.099406 s / iter per device, on 4 devices)
[10/20 16:53:10] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[10/20 16:53:10] detectron2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 16:53:10] detectron2.data.common INFO: Serializing 5104 elements to byte tensors and concatenating them all ...
[10/20 16:53:10] detectron2.data.common INFO: Serialized dataset takes 39.02 MiB
[10/20 16:53:10] detectron2.evaluation.evaluator INFO: Start inference on 1276 batches
[10/20 16:53:26] detectron2.evaluation.evaluator INFO: Inference done 1/1276. Dataloading: 5.7840 s/iter. Inference: 10.2842 s/iter. Eval: 0.0120 s/iter. Total: 16.0828 s/iter. ETA=5:41:45
[10/20 16:53:31] detectron2.evaluation.evaluator INFO: Inference done 47/1276. Dataloading: 0.0028 s/iter. Inference: 0.0976 s/iter. Eval: 0.0099 s/iter. Total: 0.1103 s/iter. ETA=0:02:15
[10/20 16:53:36] detectron2.evaluation.evaluator INFO: Inference done 93/1276. Dataloading: 0.0028 s/iter. Inference: 0.0979 s/iter. Eval: 0.0095 s/iter. Total: 0.1103 s/iter. ETA=0:02:10
[10/20 16:53:41] detectron2.evaluation.evaluator INFO: Inference done 139/1276. Dataloading: 0.0028 s/iter. Inference: 0.0976 s/iter. Eval: 0.0094 s/iter. Total: 0.1099 s/iter. ETA=0:02:04
[10/20 16:53:46] detectron2.evaluation.evaluator INFO: Inference done 185/1276. Dataloading: 0.0028 s/iter. Inference: 0.0976 s/iter. Eval: 0.0094 s/iter. Total: 0.1099 s/iter. ETA=0:01:59
[10/20 16:53:51] detectron2.evaluation.evaluator INFO: Inference done 231/1276. Dataloading: 0.0029 s/iter. Inference: 0.0977 s/iter. Eval: 0.0094 s/iter. Total: 0.1100 s/iter. ETA=0:01:54
[10/20 16:53:56] detectron2.evaluation.evaluator INFO: Inference done 276/1276. Dataloading: 0.0029 s/iter. Inference: 0.0978 s/iter. Eval: 0.0096 s/iter. Total: 0.1103 s/iter. ETA=0:01:50
[10/20 16:54:01] detectron2.evaluation.evaluator INFO: Inference done 321/1276. Dataloading: 0.0029 s/iter. Inference: 0.0981 s/iter. Eval: 0.0095 s/iter. Total: 0.1105 s/iter. ETA=0:01:45
[10/20 16:54:06] detectron2.evaluation.evaluator INFO: Inference done 366/1276. Dataloading: 0.0029 s/iter. Inference: 0.0982 s/iter. Eval: 0.0095 s/iter. Total: 0.1107 s/iter. ETA=0:01:40
[10/20 16:54:12] detectron2.evaluation.evaluator INFO: Inference done 411/1276. Dataloading: 0.0029 s/iter. Inference: 0.0984 s/iter. Eval: 0.0096 s/iter. Total: 0.1110 s/iter. ETA=0:01:35
[10/20 16:54:17] detectron2.evaluation.evaluator INFO: Inference done 456/1276. Dataloading: 0.0029 s/iter. Inference: 0.0985 s/iter. Eval: 0.0096 s/iter. Total: 0.1110 s/iter. ETA=0:01:31
[10/20 16:54:22] detectron2.evaluation.evaluator INFO: Inference done 502/1276. Dataloading: 0.0029 s/iter. Inference: 0.0985 s/iter. Eval: 0.0095 s/iter. Total: 0.1110 s/iter. ETA=0:01:25
[10/20 16:54:27] detectron2.evaluation.evaluator INFO: Inference done 548/1276. Dataloading: 0.0029 s/iter. Inference: 0.0985 s/iter. Eval: 0.0094 s/iter. Total: 0.1109 s/iter. ETA=0:01:20
[10/20 16:54:32] detectron2.evaluation.evaluator INFO: Inference done 593/1276. Dataloading: 0.0029 s/iter. Inference: 0.0985 s/iter. Eval: 0.0095 s/iter. Total: 0.1109 s/iter. ETA=0:01:15
[10/20 16:54:37] detectron2.evaluation.evaluator INFO: Inference done 638/1276. Dataloading: 0.0029 s/iter. Inference: 0.0985 s/iter. Eval: 0.0095 s/iter. Total: 0.1109 s/iter. ETA=0:01:10
[10/20 16:54:42] detectron2.evaluation.evaluator INFO: Inference done 684/1276. Dataloading: 0.0029 s/iter. Inference: 0.0985 s/iter. Eval: 0.0095 s/iter. Total: 0.1109 s/iter. ETA=0:01:05
[10/20 16:54:47] detectron2.evaluation.evaluator INFO: Inference done 729/1276. Dataloading: 0.0029 s/iter. Inference: 0.0986 s/iter. Eval: 0.0095 s/iter. Total: 0.1110 s/iter. ETA=0:01:00
[10/20 16:54:52] detectron2.evaluation.evaluator INFO: Inference done 774/1276. Dataloading: 0.0029 s/iter. Inference: 0.0987 s/iter. Eval: 0.0095 s/iter. Total: 0.1111 s/iter. ETA=0:00:55
[10/20 16:54:57] detectron2.evaluation.evaluator INFO: Inference done 820/1276. Dataloading: 0.0029 s/iter. Inference: 0.0987 s/iter. Eval: 0.0095 s/iter. Total: 0.1111 s/iter. ETA=0:00:50
[10/20 16:55:02] detectron2.evaluation.evaluator INFO: Inference done 866/1276. Dataloading: 0.0029 s/iter. Inference: 0.0987 s/iter. Eval: 0.0095 s/iter. Total: 0.1111 s/iter. ETA=0:00:45
[10/20 16:55:07] detectron2.evaluation.evaluator INFO: Inference done 912/1276. Dataloading: 0.0029 s/iter. Inference: 0.0986 s/iter. Eval: 0.0095 s/iter. Total: 0.1110 s/iter. ETA=0:00:40
[10/20 16:55:12] detectron2.evaluation.evaluator INFO: Inference done 957/1276. Dataloading: 0.0029 s/iter. Inference: 0.0987 s/iter. Eval: 0.0095 s/iter. Total: 0.1111 s/iter. ETA=0:00:35
[10/20 16:55:17] detectron2.evaluation.evaluator INFO: Inference done 1003/1276. Dataloading: 0.0029 s/iter. Inference: 0.0986 s/iter. Eval: 0.0095 s/iter. Total: 0.1110 s/iter. ETA=0:00:30
[10/20 16:55:22] detectron2.evaluation.evaluator INFO: Inference done 1048/1276. Dataloading: 0.0029 s/iter. Inference: 0.0986 s/iter. Eval: 0.0095 s/iter. Total: 0.1110 s/iter. ETA=0:00:25
[10/20 16:55:27] detectron2.evaluation.evaluator INFO: Inference done 1094/1276. Dataloading: 0.0029 s/iter. Inference: 0.0985 s/iter. Eval: 0.0095 s/iter. Total: 0.1109 s/iter. ETA=0:00:20
[10/20 16:55:32] detectron2.evaluation.evaluator INFO: Inference done 1140/1276. Dataloading: 0.0029 s/iter. Inference: 0.0984 s/iter. Eval: 0.0095 s/iter. Total: 0.1109 s/iter. ETA=0:00:15
[10/20 16:55:37] detectron2.evaluation.evaluator INFO: Inference done 1186/1276. Dataloading: 0.0029 s/iter. Inference: 0.0984 s/iter. Eval: 0.0095 s/iter. Total: 0.1109 s/iter. ETA=0:00:09
[10/20 16:55:42] detectron2.evaluation.evaluator INFO: Inference done 1232/1276. Dataloading: 0.0029 s/iter. Inference: 0.0984 s/iter. Eval: 0.0095 s/iter. Total: 0.1108 s/iter. ETA=0:00:04
[10/20 16:55:49] detectron2.evaluation.evaluator INFO: Total inference time: 0:02:22.154640 (0.111845 s / iter per device, on 4 devices)
[10/20 16:55:49] detectron2.evaluation.evaluator INFO: Total inference pure compute time: 0:02:05 (0.098349 s / iter per device, on 4 devices)
[10/20 16:56:05] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[10/20 16:56:05] detectron2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 16:56:05] detectron2.data.common INFO: Serializing 5104 elements to byte tensors and concatenating them all ...
[10/20 16:56:05] detectron2.data.common INFO: Serialized dataset takes 8.84 MiB
[10/20 16:56:05] detectron2.evaluation.evaluator INFO: Start inference on 1276 batches
[10/20 16:56:16] detectron2.evaluation.evaluator INFO: Inference done 11/1276. Dataloading: 0.0016 s/iter. Inference: 0.0916 s/iter. Eval: 0.0088 s/iter. Total: 0.1020 s/iter. ETA=0:02:08
[10/20 16:56:21] detectron2.evaluation.evaluator INFO: Inference done 59/1276. Dataloading: 0.0027 s/iter. Inference: 0.0926 s/iter. Eval: 0.0093 s/iter. Total: 0.1047 s/iter. ETA=0:02:07
[10/20 16:56:26] detectron2.evaluation.evaluator INFO: Inference done 105/1276. Dataloading: 0.0028 s/iter. Inference: 0.0943 s/iter. Eval: 0.0096 s/iter. Total: 0.1068 s/iter. ETA=0:02:05
[10/20 16:56:31] detectron2.evaluation.evaluator INFO: Inference done 154/1276. Dataloading: 0.0028 s/iter. Inference: 0.0933 s/iter. Eval: 0.0095 s/iter. Total: 0.1056 s/iter. ETA=0:01:58
[10/20 16:56:36] detectron2.evaluation.evaluator INFO: Inference done 202/1276. Dataloading: 0.0027 s/iter. Inference: 0.0933 s/iter. Eval: 0.0093 s/iter. Total: 0.1054 s/iter. ETA=0:01:53
[10/20 16:56:41] detectron2.evaluation.evaluator INFO: Inference done 251/1276. Dataloading: 0.0027 s/iter. Inference: 0.0930 s/iter. Eval: 0.0093 s/iter. Total: 0.1051 s/iter. ETA=0:01:47
[10/20 16:56:46] detectron2.evaluation.evaluator INFO: Inference done 299/1276. Dataloading: 0.0027 s/iter. Inference: 0.0931 s/iter. Eval: 0.0092 s/iter. Total: 0.1051 s/iter. ETA=0:01:42
[10/20 16:56:51] detectron2.evaluation.evaluator INFO: Inference done 346/1276. Dataloading: 0.0027 s/iter. Inference: 0.0933 s/iter. Eval: 0.0092 s/iter. Total: 0.1053 s/iter. ETA=0:01:37
[10/20 16:56:56] detectron2.evaluation.evaluator INFO: Inference done 395/1276. Dataloading: 0.0027 s/iter. Inference: 0.0932 s/iter. Eval: 0.0091 s/iter. Total: 0.1051 s/iter. ETA=0:01:32
[10/20 16:57:01] detectron2.evaluation.evaluator INFO: Inference done 443/1276. Dataloading: 0.0027 s/iter. Inference: 0.0934 s/iter. Eval: 0.0090 s/iter. Total: 0.1052 s/iter. ETA=0:01:27
[10/20 16:57:06] detectron2.evaluation.evaluator INFO: Inference done 491/1276. Dataloading: 0.0027 s/iter. Inference: 0.0934 s/iter. Eval: 0.0090 s/iter. Total: 0.1051 s/iter. ETA=0:01:22
[10/20 16:57:11] detectron2.evaluation.evaluator INFO: Inference done 539/1276. Dataloading: 0.0027 s/iter. Inference: 0.0933 s/iter. Eval: 0.0090 s/iter. Total: 0.1051 s/iter. ETA=0:01:17
[10/20 16:57:16] detectron2.evaluation.evaluator INFO: Inference done 587/1276. Dataloading: 0.0027 s/iter. Inference: 0.0934 s/iter. Eval: 0.0090 s/iter. Total: 0.1051 s/iter. ETA=0:01:12
[10/20 16:57:21] detectron2.evaluation.evaluator INFO: Inference done 635/1276. Dataloading: 0.0027 s/iter. Inference: 0.0933 s/iter. Eval: 0.0090 s/iter. Total: 0.1051 s/iter. ETA=0:01:07
[10/20 16:57:26] detectron2.evaluation.evaluator INFO: Inference done 683/1276. Dataloading: 0.0027 s/iter. Inference: 0.0933 s/iter. Eval: 0.0090 s/iter. Total: 0.1050 s/iter. ETA=0:01:02
[10/20 16:57:31] detectron2.evaluation.evaluator INFO: Inference done 731/1276. Dataloading: 0.0027 s/iter. Inference: 0.0933 s/iter. Eval: 0.0090 s/iter. Total: 0.1051 s/iter. ETA=0:00:57
[10/20 16:57:36] detectron2.evaluation.evaluator INFO: Inference done 778/1276. Dataloading: 0.0026 s/iter. Inference: 0.0935 s/iter. Eval: 0.0090 s/iter. Total: 0.1052 s/iter. ETA=0:00:52
[10/20 16:57:41] detectron2.evaluation.evaluator INFO: Inference done 825/1276. Dataloading: 0.0026 s/iter. Inference: 0.0935 s/iter. Eval: 0.0091 s/iter. Total: 0.1053 s/iter. ETA=0:00:47
[10/20 16:57:47] detectron2.evaluation.evaluator INFO: Inference done 874/1276. Dataloading: 0.0026 s/iter. Inference: 0.0934 s/iter. Eval: 0.0091 s/iter. Total: 0.1052 s/iter. ETA=0:00:42
[10/20 16:57:52] detectron2.evaluation.evaluator INFO: Inference done 923/1276. Dataloading: 0.0026 s/iter. Inference: 0.0933 s/iter. Eval: 0.0091 s/iter. Total: 0.1051 s/iter. ETA=0:00:37
[10/20 16:57:57] detectron2.evaluation.evaluator INFO: Inference done 971/1276. Dataloading: 0.0026 s/iter. Inference: 0.0934 s/iter. Eval: 0.0091 s/iter. Total: 0.1051 s/iter. ETA=0:00:32
[10/20 16:58:02] detectron2.evaluation.evaluator INFO: Inference done 1020/1276. Dataloading: 0.0026 s/iter. Inference: 0.0933 s/iter. Eval: 0.0091 s/iter. Total: 0.1051 s/iter. ETA=0:00:26
[10/20 16:58:07] detectron2.evaluation.evaluator INFO: Inference done 1069/1276. Dataloading: 0.0026 s/iter. Inference: 0.0932 s/iter. Eval: 0.0090 s/iter. Total: 0.1050 s/iter. ETA=0:00:21
[10/20 16:58:12] detectron2.evaluation.evaluator INFO: Inference done 1118/1276. Dataloading: 0.0026 s/iter. Inference: 0.0932 s/iter. Eval: 0.0090 s/iter. Total: 0.1049 s/iter. ETA=0:00:16
[10/20 16:58:17] detectron2.evaluation.evaluator INFO: Inference done 1166/1276. Dataloading: 0.0026 s/iter. Inference: 0.0932 s/iter. Eval: 0.0090 s/iter. Total: 0.1049 s/iter. ETA=0:00:11
[10/20 16:58:22] detectron2.evaluation.evaluator INFO: Inference done 1214/1276. Dataloading: 0.0026 s/iter. Inference: 0.0932 s/iter. Eval: 0.0090 s/iter. Total: 0.1049 s/iter. ETA=0:00:06
[10/20 16:58:27] detectron2.evaluation.evaluator INFO: Inference done 1263/1276. Dataloading: 0.0026 s/iter. Inference: 0.0931 s/iter. Eval: 0.0090 s/iter. Total: 0.1048 s/iter. ETA=0:00:01
[10/20 16:58:30] detectron2.evaluation.evaluator INFO: Total inference time: 0:02:14.761111 (0.106028 s / iter per device, on 4 devices)
[10/20 16:58:30] detectron2.evaluation.evaluator INFO: Total inference pure compute time: 0:01:58 (0.093109 s / iter per device, on 4 devices)
[10/20 16:58:46] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[10/20 16:58:46] detectron2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 16:58:46] detectron2.data.common INFO: Serializing 2000 elements to byte tensors and concatenating them all ...
[10/20 16:58:46] detectron2.data.common INFO: Serialized dataset takes 15.18 MiB
[10/20 16:58:46] detectron2.evaluation.evaluator INFO: Start inference on 500 batches
[10/20 16:58:59] detectron2.evaluation.evaluator INFO: Inference done 1/500. Dataloading: 5.7254 s/iter. Inference: 7.3782 s/iter. Eval: 0.0216 s/iter. Total: 13.1384 s/iter. ETA=1:49:16
[10/20 16:59:04] detectron2.evaluation.evaluator INFO: Inference done 48/500. Dataloading: 0.0026 s/iter. Inference: 0.0897 s/iter. Eval: 0.0145 s/iter. Total: 0.1068 s/iter. ETA=0:00:48
[10/20 16:59:09] detectron2.evaluation.evaluator INFO: Inference done 95/500. Dataloading: 0.0027 s/iter. Inference: 0.0903 s/iter. Eval: 0.0141 s/iter. Total: 0.1071 s/iter. ETA=0:00:43
[10/20 16:59:14] detectron2.evaluation.evaluator INFO: Inference done 144/500. Dataloading: 0.0027 s/iter. Inference: 0.0895 s/iter. Eval: 0.0138 s/iter. Total: 0.1062 s/iter. ETA=0:00:37
[10/20 16:59:19] detectron2.evaluation.evaluator INFO: Inference done 188/500. Dataloading: 0.0028 s/iter. Inference: 0.0903 s/iter. Eval: 0.0149 s/iter. Total: 0.1080 s/iter. ETA=0:00:33
[10/20 16:59:24] detectron2.evaluation.evaluator INFO: Inference done 238/500. Dataloading: 0.0027 s/iter. Inference: 0.0896 s/iter. Eval: 0.0139 s/iter. Total: 0.1063 s/iter. ETA=0:00:27
[10/20 16:59:29] detectron2.evaluation.evaluator INFO: Inference done 290/500. Dataloading: 0.0027 s/iter. Inference: 0.0886 s/iter. Eval: 0.0133 s/iter. Total: 0.1047 s/iter. ETA=0:00:21
[10/20 16:59:35] detectron2.evaluation.evaluator INFO: Inference done 338/500. Dataloading: 0.0028 s/iter. Inference: 0.0889 s/iter. Eval: 0.0133 s/iter. Total: 0.1050 s/iter. ETA=0:00:17
[10/20 16:59:40] detectron2.evaluation.evaluator INFO: Inference done 388/500. Dataloading: 0.0028 s/iter. Inference: 0.0886 s/iter. Eval: 0.0130 s/iter. Total: 0.1044 s/iter. ETA=0:00:11
[10/20 16:59:45] detectron2.evaluation.evaluator INFO: Inference done 439/500. Dataloading: 0.0027 s/iter. Inference: 0.0883 s/iter. Eval: 0.0127 s/iter. Total: 0.1037 s/iter. ETA=0:00:06
[10/20 16:59:50] detectron2.evaluation.evaluator INFO: Inference done 487/500. Dataloading: 0.0027 s/iter. Inference: 0.0884 s/iter. Eval: 0.0126 s/iter. Total: 0.1038 s/iter. ETA=0:00:01
[10/20 16:59:52] detectron2.evaluation.evaluator INFO: Total inference time: 0:00:52.626164 (0.106315 s / iter per device, on 4 devices)
[10/20 16:59:52] detectron2.evaluation.evaluator INFO: Total inference pure compute time: 0:00:43 (0.088242 s / iter per device, on 4 devices)
[10/28 11:21:56] detectron2 INFO: Rank of current process: 2. World size: 3
[10/28 11:21:56] detectron2 INFO: Environment info:
-------------------------------  ------------------------------------------------------------------------
sys.platform                     linux
Python                           3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
numpy                            1.22.4
detectron2                       0.6 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/detectron2
Compiler                         GCC 9.4
CUDA compiler                    CUDA 11.8
detectron2 arch flags            8.6
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          2.4.1 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0,1,2                        NVIDIA GeForce RTX 3090 (arch=8.6)
Driver version                   550.144.03
CUDA_HOME                        /data/hmp/CUDA/11.8
Pillow                           9.3.0
torchvision                      0.20.0 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/torchvision
torchvision arch flags           3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              4.12.0
-------------------------------  ------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

[10/28 11:21:56] detectron2 INFO: Command line arguments: Namespace(config_file='configs/semantic/eval_PE.yaml', dist_url='tcp://127.0.0.1:50185', eval_only=True, machine_rank=0, num_gpus=3, num_machines=1, opts=[], resume=False)
[10/28 11:21:56] detectron2 INFO: Contents of args.config_file=configs/semantic/eval_PE.yaml:
# python train_net.py --config-file configs/semantic/eval.yaml  --num-gpus 8 --eval-only

_BASE_: ./train_semantic_large.yaml
MODEL:
  BACKBONE:
    NAME: "PEEncoder"
  META_ARCHITECTURE: "MAFT_Plus"


DATASETS:
  # TEST: ("openvocab_pascal20_sem_seg_val", "openvocab_ade20k_full_sem_seg_val", 'openvocab_pascal_ctx459_sem_seg_val', 'openvocab_pascal_ctx59_sem_seg_val', 'openvocab_ade20k_panoptic_val') 
  TEST: ( 'openvocab_ade20k_panoptic_val',)

OUTPUT_DIR: ./out/semantic/evaluation

PE:
  ENABLED: True
  MODEL_NAME: "PE-Core-L14-336"
[10/28 11:22:18] detectron2.engine.defaults INFO: Model:
MAFT_Plus(
  (backbone): PEEncoder(
    (pe_model): CLIP(
      (token_embedding): Embedding(49408, 1024)
      (transformer): Transformer(
        (resblocks): ModuleList(
          (0-23): 24 x ResidualAttentionBlock(
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=1024, out_features=1024, bias=True)
            )
            (ls_1): Identity()
            (ls_2): Identity()
            (ln_1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ln_2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (drop_path1): Identity()
            (drop_path2): Identity()
            (mlp): Sequential(
              (c_fc): Linear(in_features=1024, out_features=4096, bias=True)
              (gelu): GELU(approximate='none')
              (c_proj): Linear(in_features=4096, out_features=1024, bias=True)
            )
          )
        )
      )
      (ln_final): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (visual): VisionTransformer(
        (conv1): Conv2d(3, 1024, kernel_size=(14, 14), stride=(14, 14), bias=False)
        (ln_pre): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (ln_post): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (transformer): Transformer(
          (resblocks): ModuleList(
            (0-23): 24 x ResidualAttentionBlock(
              (attn): SelfAttention(
                (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
              )
              (ls_1): Identity()
              (ls_2): Identity()
              (ln_1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (ln_2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (drop_path1): Identity()
              (drop_path2): Identity()
              (mlp): Sequential(
                (c_fc): Linear(in_features=1024, out_features=4096, bias=True)
                (gelu): GELU(approximate='none')
                (c_proj): Linear(in_features=4096, out_features=1024, bias=True)
              )
            )
          )
        )
        (attn_pool): AttentionPooling(
          (attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=1024, out_features=1024, bias=True)
          )
          (layernorm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (mlp): Sequential(
            (c_fc): Linear(in_features=1024, out_features=4096, bias=True)
            (gelu): GELU(approximate='none')
            (c_proj): Linear(in_features=4096, out_features=1024, bias=True)
          )
        )
      )
    )
  )
  (void_embedding): Embedding(1, 1024)
)
[10/28 11:22:18] detectron2.checkpoint.detection_checkpoint INFO: [DetectionCheckpointer] Loading from  ...
[10/28 11:22:18] fvcore.common.checkpoint INFO: No checkpoint found. Initializing model from scratch
[10/28 11:22:19] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[10/28 11:22:19] detectron2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/28 11:22:19] detectron2.data.common INFO: Serializing 2000 elements to byte tensors and concatenating them all ...
[10/28 11:22:19] detectron2.data.common INFO: Serialized dataset takes 15.18 MiB
[10/28 11:22:19] detectron2.evaluation.evaluator INFO: Start inference on 666 batches
