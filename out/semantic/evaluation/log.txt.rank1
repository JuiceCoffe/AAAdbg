[10/20 16:50:18] detectron2 INFO: Rank of current process: 1. World size: 4
[10/20 16:50:19] detectron2 INFO: Environment info:
-------------------------------  ------------------------------------------------------------------------
sys.platform                     linux
Python                           3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
numpy                            1.22.4
detectron2                       0.6 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/detectron2
Compiler                         GCC 9.4
CUDA compiler                    CUDA 11.8
detectron2 arch flags            8.6
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          2.4.1 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0,1,2,3                      NVIDIA GeForce RTX 3090 (arch=8.6)
Driver version                   550.144.03
CUDA_HOME                        /data/hmp/CUDA/11.8
Pillow                           9.3.0
torchvision                      0.20.0 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/torchvision
torchvision arch flags           3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              4.12.0
-------------------------------  ------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

[10/20 16:50:19] detectron2 INFO: Command line arguments: Namespace(config_file='configs/semantic/eval.yaml', dist_url='tcp://127.0.0.1:50185', eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=[], resume=False)
[10/20 16:50:19] detectron2 INFO: Contents of args.config_file=configs/semantic/eval.yaml:
# python train_net.py --config-file configs/semantic/eval.yaml  --num-gpus 8 --eval-only

_BASE_: ./train_semantic_large.yaml
MODEL:
  WEIGHTS: out/semantic/MAFT_Plus/maftp_l.pth  # path to maftp_l.pth
  META_ARCHITECTURE: "MAFT_Plus"
  FC_CLIP:
    CLIP_MODEL_NAME: "convnext_large_d_320"  
    CLIP_PRETRAINED_WEIGHTS: "laion2b_s29b_b131k_ft_soup" 
    EMBED_DIM: 768
    GEOMETRIC_ENSEMBLE_ALPHA: -1.
    GEOMETRIC_ENSEMBLE_BETA: -1.

DATASETS:
  TEST: ("openvocab_pascal20_sem_seg_val", "openvocab_ade20k_full_sem_seg_val", 'openvocab_pascal_ctx459_sem_seg_val', 'openvocab_pascal_ctx59_sem_seg_val', 'openvocab_ade20k_panoptic_val') 
  # TEST: ("openvocab_ade20k_full_sem_seg_val",) #'openvocab_ade20k_panoptic_val',)

OUTPUT_DIR: ./out/semantic/evaluation

[10/20 16:50:37] detectron2.engine.defaults INFO: Model:
MAFT_Plus(
  (backbone): CLIP(
    (clip_model): CLIP(
      (visual): TimmModel(
        (trunk): ConvNeXt(
          (stem): Sequential(
            (0): Conv2d(3, 192, kernel_size=(4, 4), stride=(4, 4))
            (1): LayerNorm2d((192,), eps=1e-06, elementwise_affine=True)
          )
          (stages): Sequential(
            (0): ConvNeXtStage(
              (downsample): Identity()
              (blocks): Sequential(
                (0): ConvNeXtBlock(
                  (conv_dw): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
                  (norm): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=192, out_features=768, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=768, out_features=192, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): Identity()
                )
                (1): ConvNeXtBlock(
                  (conv_dw): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
                  (norm): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=192, out_features=768, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=768, out_features=192, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.003)
                )
                (2): ConvNeXtBlock(
                  (conv_dw): Conv2d(192, 192, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=192)
                  (norm): LayerNorm((192,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=192, out_features=768, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=768, out_features=192, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.006)
                )
              )
            )
            (1): ConvNeXtStage(
              (downsample): Sequential(
                (0): LayerNorm2d((192,), eps=1e-06, elementwise_affine=True)
                (1): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
              )
              (blocks): Sequential(
                (0): ConvNeXtBlock(
                  (conv_dw): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
                  (norm): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=384, out_features=1536, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=1536, out_features=384, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.009)
                )
                (1): ConvNeXtBlock(
                  (conv_dw): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
                  (norm): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=384, out_features=1536, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=1536, out_features=384, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.011)
                )
                (2): ConvNeXtBlock(
                  (conv_dw): Conv2d(384, 384, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=384)
                  (norm): LayerNorm((384,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=384, out_features=1536, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=1536, out_features=384, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.014)
                )
              )
            )
            (2): ConvNeXtStage(
              (downsample): Sequential(
                (0): LayerNorm2d((384,), eps=1e-06, elementwise_affine=True)
                (1): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
              )
              (blocks): Sequential(
                (0): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.017)
                )
                (1): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.020)
                )
                (2): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.023)
                )
                (3): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.026)
                )
                (4): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.029)
                )
                (5): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.031)
                )
                (6): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.034)
                )
                (7): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.037)
                )
                (8): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.040)
                )
                (9): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.043)
                )
                (10): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.046)
                )
                (11): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.049)
                )
                (12): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.051)
                )
                (13): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.054)
                )
                (14): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.057)
                )
                (15): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.060)
                )
                (16): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.063)
                )
                (17): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.066)
                )
                (18): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.069)
                )
                (19): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.071)
                )
                (20): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.074)
                )
                (21): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.077)
                )
                (22): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.080)
                )
                (23): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.083)
                )
                (24): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.086)
                )
                (25): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.089)
                )
                (26): ConvNeXtBlock(
                  (conv_dw): Conv2d(768, 768, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=768)
                  (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=768, out_features=3072, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=3072, out_features=768, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.091)
                )
              )
            )
            (3): ConvNeXtStage(
              (downsample): Sequential(
                (0): LayerNorm2d((768,), eps=1e-06, elementwise_affine=True)
                (1): Conv2d(768, 1536, kernel_size=(2, 2), stride=(2, 2))
              )
              (blocks): Sequential(
                (0): ConvNeXtBlock(
                  (conv_dw): Conv2d(1536, 1536, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=1536)
                  (norm): LayerNorm((1536,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.094)
                )
                (1): ConvNeXtBlock(
                  (conv_dw): Conv2d(1536, 1536, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=1536)
                  (norm): LayerNorm((1536,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.097)
                )
                (2): ConvNeXtBlock(
                  (conv_dw): Conv2d(1536, 1536, kernel_size=(7, 7), stride=(1, 1), padding=(3, 3), groups=1536)
                  (norm): LayerNorm((1536,), eps=1e-06, elementwise_affine=True)
                  (mlp): Mlp(
                    (fc1): Linear(in_features=1536, out_features=6144, bias=True)
                    (act): GELU()
                    (drop1): Dropout(p=0.0, inplace=False)
                    (norm): Identity()
                    (fc2): Linear(in_features=6144, out_features=1536, bias=True)
                    (drop2): Dropout(p=0.0, inplace=False)
                  )
                  (shortcut): Identity()
                  (drop_path): DropPath(drop_prob=0.100)
                )
              )
            )
          )
          (norm_pre): Identity()
          (head): NormMlpClassifierHead(
            (global_pool): SelectAdaptivePool2d(pool_type=avg, flatten=Identity())
            (norm): LayerNorm2d((1536,), eps=1e-06, elementwise_affine=True)
            (flatten): Flatten(start_dim=1, end_dim=-1)
            (pre_logits): Identity()
            (drop): Dropout(p=0.0, inplace=False)
            (fc): Identity()
          )
        )
        (head): Sequential(
          (mlp): Mlp(
            (fc1): Linear(in_features=1536, out_features=1536, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0.0, inplace=False)
            (norm): Identity()
            (fc2): Linear(in_features=1536, out_features=768, bias=False)
            (drop2): Dropout(p=0, inplace=False)
          )
        )
      )
      (transformer): Transformer(
        (resblocks): ModuleList(
          (0-15): 16 x ResidualAttentionBlock(
            (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): MultiheadAttention(
              (out_proj): NonDynamicallyQuantizableLinear(in_features=768, out_features=768, bias=True)
            )
            (ls_1): Identity()
            (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Sequential(
              (c_fc): Linear(in_features=768, out_features=3072, bias=True)
              (gelu): GELU(approximate='none')
              (c_proj): Linear(in_features=3072, out_features=768, bias=True)
            )
            (ls_2): Identity()
          )
        )
      )
      (token_embedding): Embedding(49408, 768)
      (ln_final): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    )
  )
  (void_embedding): Embedding(1, 768)
)
[10/20 16:50:37] detectron2.checkpoint.detection_checkpoint INFO: [DetectionCheckpointer] Loading from out/semantic/MAFT_Plus/maftp_l.pth ...
[10/20 16:50:37] fvcore.common.checkpoint INFO: [Checkpointer] Loading from out/semantic/MAFT_Plus/maftp_l.pth ...
[10/20 16:50:37] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[10/20 16:50:37] detectron2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 16:50:37] detectron2.data.common INFO: Serializing 1449 elements to byte tensors and concatenating them all ...
[10/20 16:50:37] detectron2.data.common INFO: Serialized dataset takes 1.38 MiB
[10/20 16:50:37] detectron2.evaluation.evaluator INFO: Start inference on 362 batches
[10/20 16:50:50] detectron2.evaluation.evaluator INFO: Inference done 11/362. Dataloading: 0.0016 s/iter. Inference: 0.0948 s/iter. Eval: 0.0082 s/iter. Total: 0.1045 s/iter. ETA=0:00:36
[10/20 16:50:55] detectron2.evaluation.evaluator INFO: Inference done 59/362. Dataloading: 0.0024 s/iter. Inference: 0.0949 s/iter. Eval: 0.0085 s/iter. Total: 0.1060 s/iter. ETA=0:00:32
[10/20 16:51:00] detectron2.evaluation.evaluator INFO: Inference done 108/362. Dataloading: 0.0025 s/iter. Inference: 0.0933 s/iter. Eval: 0.0085 s/iter. Total: 0.1044 s/iter. ETA=0:00:26
[10/20 16:51:05] detectron2.evaluation.evaluator INFO: Inference done 157/362. Dataloading: 0.0025 s/iter. Inference: 0.0933 s/iter. Eval: 0.0084 s/iter. Total: 0.1043 s/iter. ETA=0:00:21
[10/20 16:51:10] detectron2.evaluation.evaluator INFO: Inference done 206/362. Dataloading: 0.0026 s/iter. Inference: 0.0931 s/iter. Eval: 0.0084 s/iter. Total: 0.1041 s/iter. ETA=0:00:16
[10/20 16:51:15] detectron2.evaluation.evaluator INFO: Inference done 254/362. Dataloading: 0.0026 s/iter. Inference: 0.0934 s/iter. Eval: 0.0084 s/iter. Total: 0.1044 s/iter. ETA=0:00:11
[10/20 16:51:20] detectron2.evaluation.evaluator INFO: Inference done 301/362. Dataloading: 0.0026 s/iter. Inference: 0.0938 s/iter. Eval: 0.0085 s/iter. Total: 0.1050 s/iter. ETA=0:00:06
[10/20 16:51:25] detectron2.evaluation.evaluator INFO: Inference done 348/362. Dataloading: 0.0026 s/iter. Inference: 0.0942 s/iter. Eval: 0.0085 s/iter. Total: 0.1053 s/iter. ETA=0:00:01
[10/20 16:51:29] detectron2.evaluation.evaluator INFO: Total inference time: 0:00:39.814984 (0.111527 s / iter per device, on 4 devices)
[10/20 16:51:29] detectron2.evaluation.evaluator INFO: Total inference pure compute time: 0:00:33 (0.094241 s / iter per device, on 4 devices)
[10/20 16:51:29] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[10/20 16:51:29] detectron2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 16:51:29] detectron2.data.common INFO: Serializing 2000 elements to byte tensors and concatenating them all ...
[10/20 16:51:29] detectron2.data.common INFO: Serialized dataset takes 27.14 MiB
[10/20 16:51:29] detectron2.evaluation.evaluator INFO: Start inference on 500 batches
[10/20 16:52:01] detectron2.evaluation.evaluator INFO: Inference done 1/500. Dataloading: 6.1558 s/iter. Inference: 25.0918 s/iter. Eval: 0.0265 s/iter. Total: 31.2772 s/iter. ETA=4:20:07
[10/20 16:52:06] detectron2.evaluation.evaluator INFO: Inference done 39/500. Dataloading: 0.0026 s/iter. Inference: 0.1130 s/iter. Eval: 0.0163 s/iter. Total: 0.1319 s/iter. ETA=0:01:00
[10/20 16:52:11] detectron2.evaluation.evaluator INFO: Inference done 81/500. Dataloading: 0.0026 s/iter. Inference: 0.1079 s/iter. Eval: 0.0156 s/iter. Total: 0.1261 s/iter. ETA=0:00:52
[10/20 16:52:16] detectron2.evaluation.evaluator INFO: Inference done 122/500. Dataloading: 0.0026 s/iter. Inference: 0.1070 s/iter. Eval: 0.0154 s/iter. Total: 0.1250 s/iter. ETA=0:00:47
[10/20 16:52:21] detectron2.evaluation.evaluator INFO: Inference done 165/500. Dataloading: 0.0026 s/iter. Inference: 0.1062 s/iter. Eval: 0.0144 s/iter. Total: 0.1232 s/iter. ETA=0:00:41
[10/20 16:52:26] detectron2.evaluation.evaluator INFO: Inference done 206/500. Dataloading: 0.0026 s/iter. Inference: 0.1064 s/iter. Eval: 0.0143 s/iter. Total: 0.1233 s/iter. ETA=0:00:36
[10/20 16:52:31] detectron2.evaluation.evaluator INFO: Inference done 248/500. Dataloading: 0.0027 s/iter. Inference: 0.1062 s/iter. Eval: 0.0139 s/iter. Total: 0.1229 s/iter. ETA=0:00:30
[10/20 16:52:36] detectron2.evaluation.evaluator INFO: Inference done 292/500. Dataloading: 0.0026 s/iter. Inference: 0.1049 s/iter. Eval: 0.0139 s/iter. Total: 0.1215 s/iter. ETA=0:00:25
[10/20 16:52:41] detectron2.evaluation.evaluator INFO: Inference done 331/500. Dataloading: 0.0026 s/iter. Inference: 0.1054 s/iter. Eval: 0.0144 s/iter. Total: 0.1224 s/iter. ETA=0:00:20
[10/20 16:52:46] detectron2.evaluation.evaluator INFO: Inference done 374/500. Dataloading: 0.0026 s/iter. Inference: 0.1047 s/iter. Eval: 0.0145 s/iter. Total: 0.1218 s/iter. ETA=0:00:15
[10/20 16:52:51] detectron2.evaluation.evaluator INFO: Inference done 417/500. Dataloading: 0.0026 s/iter. Inference: 0.1044 s/iter. Eval: 0.0142 s/iter. Total: 0.1213 s/iter. ETA=0:00:10
[10/20 16:52:56] detectron2.evaluation.evaluator INFO: Inference done 459/500. Dataloading: 0.0027 s/iter. Inference: 0.1043 s/iter. Eval: 0.0142 s/iter. Total: 0.1213 s/iter. ETA=0:00:04
[10/20 16:53:02] detectron2.evaluation.evaluator INFO: Total inference time: 0:01:01.221650 (0.123680 s / iter per device, on 4 devices)
[10/20 16:53:02] detectron2.evaluation.evaluator INFO: Total inference pure compute time: 0:00:51 (0.104089 s / iter per device, on 4 devices)
[10/20 16:53:09] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[10/20 16:53:09] detectron2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 16:53:09] detectron2.data.common INFO: Serializing 5104 elements to byte tensors and concatenating them all ...
[10/20 16:53:10] detectron2.data.common INFO: Serialized dataset takes 39.02 MiB
[10/20 16:53:10] detectron2.evaluation.evaluator INFO: Start inference on 1276 batches
[10/20 16:53:27] detectron2.evaluation.evaluator INFO: Inference done 1/1276. Dataloading: 6.4200 s/iter. Inference: 10.3731 s/iter. Eval: 0.0092 s/iter. Total: 16.8047 s/iter. ETA=5:57:06
[10/20 16:53:32] detectron2.evaluation.evaluator INFO: Inference done 46/1276. Dataloading: 0.0026 s/iter. Inference: 0.1005 s/iter. Eval: 0.0091 s/iter. Total: 0.1123 s/iter. ETA=0:02:18
[10/20 16:53:37] detectron2.evaluation.evaluator INFO: Inference done 89/1276. Dataloading: 0.0026 s/iter. Inference: 0.1031 s/iter. Eval: 0.0089 s/iter. Total: 0.1146 s/iter. ETA=0:02:16
[10/20 16:53:42] detectron2.evaluation.evaluator INFO: Inference done 133/1276. Dataloading: 0.0026 s/iter. Inference: 0.1030 s/iter. Eval: 0.0087 s/iter. Total: 0.1144 s/iter. ETA=0:02:10
[10/20 16:53:47] detectron2.evaluation.evaluator INFO: Inference done 178/1276. Dataloading: 0.0026 s/iter. Inference: 0.1026 s/iter. Eval: 0.0088 s/iter. Total: 0.1141 s/iter. ETA=0:02:05
[10/20 16:53:52] detectron2.evaluation.evaluator INFO: Inference done 222/1276. Dataloading: 0.0026 s/iter. Inference: 0.1028 s/iter. Eval: 0.0088 s/iter. Total: 0.1143 s/iter. ETA=0:02:00
[10/20 16:53:57] detectron2.evaluation.evaluator INFO: Inference done 267/1276. Dataloading: 0.0027 s/iter. Inference: 0.1024 s/iter. Eval: 0.0088 s/iter. Total: 0.1139 s/iter. ETA=0:01:54
[10/20 16:54:02] detectron2.evaluation.evaluator INFO: Inference done 311/1276. Dataloading: 0.0027 s/iter. Inference: 0.1023 s/iter. Eval: 0.0089 s/iter. Total: 0.1139 s/iter. ETA=0:01:49
[10/20 16:54:07] detectron2.evaluation.evaluator INFO: Inference done 356/1276. Dataloading: 0.0027 s/iter. Inference: 0.1020 s/iter. Eval: 0.0089 s/iter. Total: 0.1137 s/iter. ETA=0:01:44
[10/20 16:54:12] detectron2.evaluation.evaluator INFO: Inference done 401/1276. Dataloading: 0.0027 s/iter. Inference: 0.1018 s/iter. Eval: 0.0090 s/iter. Total: 0.1135 s/iter. ETA=0:01:39
[10/20 16:54:17] detectron2.evaluation.evaluator INFO: Inference done 446/1276. Dataloading: 0.0027 s/iter. Inference: 0.1016 s/iter. Eval: 0.0090 s/iter. Total: 0.1133 s/iter. ETA=0:01:34
[10/20 16:54:22] detectron2.evaluation.evaluator INFO: Inference done 492/1276. Dataloading: 0.0027 s/iter. Inference: 0.1013 s/iter. Eval: 0.0089 s/iter. Total: 0.1130 s/iter. ETA=0:01:28
[10/20 16:54:27] detectron2.evaluation.evaluator INFO: Inference done 537/1276. Dataloading: 0.0027 s/iter. Inference: 0.1013 s/iter. Eval: 0.0089 s/iter. Total: 0.1130 s/iter. ETA=0:01:23
[10/20 16:54:32] detectron2.evaluation.evaluator INFO: Inference done 583/1276. Dataloading: 0.0027 s/iter. Inference: 0.1012 s/iter. Eval: 0.0089 s/iter. Total: 0.1129 s/iter. ETA=0:01:18
[10/20 16:54:37] detectron2.evaluation.evaluator INFO: Inference done 629/1276. Dataloading: 0.0027 s/iter. Inference: 0.1011 s/iter. Eval: 0.0089 s/iter. Total: 0.1127 s/iter. ETA=0:01:12
[10/20 16:54:43] detectron2.evaluation.evaluator INFO: Inference done 674/1276. Dataloading: 0.0027 s/iter. Inference: 0.1010 s/iter. Eval: 0.0089 s/iter. Total: 0.1127 s/iter. ETA=0:01:07
[10/20 16:54:48] detectron2.evaluation.evaluator INFO: Inference done 720/1276. Dataloading: 0.0027 s/iter. Inference: 0.1008 s/iter. Eval: 0.0089 s/iter. Total: 0.1125 s/iter. ETA=0:01:02
[10/20 16:54:53] detectron2.evaluation.evaluator INFO: Inference done 766/1276. Dataloading: 0.0027 s/iter. Inference: 0.1007 s/iter. Eval: 0.0089 s/iter. Total: 0.1124 s/iter. ETA=0:00:57
[10/20 16:54:58] detectron2.evaluation.evaluator INFO: Inference done 812/1276. Dataloading: 0.0027 s/iter. Inference: 0.1006 s/iter. Eval: 0.0089 s/iter. Total: 0.1123 s/iter. ETA=0:00:52
[10/20 16:55:03] detectron2.evaluation.evaluator INFO: Inference done 858/1276. Dataloading: 0.0027 s/iter. Inference: 0.1005 s/iter. Eval: 0.0089 s/iter. Total: 0.1122 s/iter. ETA=0:00:46
[10/20 16:55:08] detectron2.evaluation.evaluator INFO: Inference done 903/1276. Dataloading: 0.0027 s/iter. Inference: 0.1005 s/iter. Eval: 0.0089 s/iter. Total: 0.1122 s/iter. ETA=0:00:41
[10/20 16:55:13] detectron2.evaluation.evaluator INFO: Inference done 949/1276. Dataloading: 0.0027 s/iter. Inference: 0.1004 s/iter. Eval: 0.0090 s/iter. Total: 0.1121 s/iter. ETA=0:00:36
[10/20 16:55:18] detectron2.evaluation.evaluator INFO: Inference done 994/1276. Dataloading: 0.0027 s/iter. Inference: 0.1004 s/iter. Eval: 0.0090 s/iter. Total: 0.1121 s/iter. ETA=0:00:31
[10/20 16:55:23] detectron2.evaluation.evaluator INFO: Inference done 1039/1276. Dataloading: 0.0027 s/iter. Inference: 0.1004 s/iter. Eval: 0.0090 s/iter. Total: 0.1122 s/iter. ETA=0:00:26
[10/20 16:55:28] detectron2.evaluation.evaluator INFO: Inference done 1084/1276. Dataloading: 0.0027 s/iter. Inference: 0.1004 s/iter. Eval: 0.0090 s/iter. Total: 0.1121 s/iter. ETA=0:00:21
[10/20 16:55:33] detectron2.evaluation.evaluator INFO: Inference done 1129/1276. Dataloading: 0.0027 s/iter. Inference: 0.1004 s/iter. Eval: 0.0090 s/iter. Total: 0.1121 s/iter. ETA=0:00:16
[10/20 16:55:38] detectron2.evaluation.evaluator INFO: Inference done 1173/1276. Dataloading: 0.0027 s/iter. Inference: 0.1004 s/iter. Eval: 0.0090 s/iter. Total: 0.1122 s/iter. ETA=0:00:11
[10/20 16:55:43] detectron2.evaluation.evaluator INFO: Inference done 1218/1276. Dataloading: 0.0027 s/iter. Inference: 0.1004 s/iter. Eval: 0.0090 s/iter. Total: 0.1122 s/iter. ETA=0:00:06
[10/20 16:55:48] detectron2.evaluation.evaluator INFO: Inference done 1264/1276. Dataloading: 0.0027 s/iter. Inference: 0.1003 s/iter. Eval: 0.0090 s/iter. Total: 0.1121 s/iter. ETA=0:00:01
[10/20 16:55:51] detectron2.evaluation.evaluator INFO: Total inference time: 0:02:23.657025 (0.113027 s / iter per device, on 4 devices)
[10/20 16:55:51] detectron2.evaluation.evaluator INFO: Total inference pure compute time: 0:02:07 (0.100376 s / iter per device, on 4 devices)
[10/20 16:56:05] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[10/20 16:56:05] detectron2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 16:56:05] detectron2.data.common INFO: Serializing 5104 elements to byte tensors and concatenating them all ...
[10/20 16:56:05] detectron2.data.common INFO: Serialized dataset takes 8.84 MiB
[10/20 16:56:05] detectron2.evaluation.evaluator INFO: Start inference on 1276 batches
[10/20 16:56:16] detectron2.evaluation.evaluator INFO: Inference done 11/1276. Dataloading: 0.0018 s/iter. Inference: 0.0931 s/iter. Eval: 0.0083 s/iter. Total: 0.1032 s/iter. ETA=0:02:10
[10/20 16:56:21] detectron2.evaluation.evaluator INFO: Inference done 59/1276. Dataloading: 0.0024 s/iter. Inference: 0.0933 s/iter. Eval: 0.0090 s/iter. Total: 0.1048 s/iter. ETA=0:02:07
[10/20 16:56:26] detectron2.evaluation.evaluator INFO: Inference done 106/1276. Dataloading: 0.0025 s/iter. Inference: 0.0941 s/iter. Eval: 0.0092 s/iter. Total: 0.1058 s/iter. ETA=0:02:03
[10/20 16:56:31] detectron2.evaluation.evaluator INFO: Inference done 154/1276. Dataloading: 0.0025 s/iter. Inference: 0.0944 s/iter. Eval: 0.0089 s/iter. Total: 0.1060 s/iter. ETA=0:01:58
[10/20 16:56:36] detectron2.evaluation.evaluator INFO: Inference done 199/1276. Dataloading: 0.0026 s/iter. Inference: 0.0957 s/iter. Eval: 0.0089 s/iter. Total: 0.1072 s/iter. ETA=0:01:55
[10/20 16:56:41] detectron2.evaluation.evaluator INFO: Inference done 245/1276. Dataloading: 0.0026 s/iter. Inference: 0.0960 s/iter. Eval: 0.0090 s/iter. Total: 0.1077 s/iter. ETA=0:01:51
[10/20 16:56:46] detectron2.evaluation.evaluator INFO: Inference done 293/1276. Dataloading: 0.0026 s/iter. Inference: 0.0959 s/iter. Eval: 0.0090 s/iter. Total: 0.1075 s/iter. ETA=0:01:45
[10/20 16:56:51] detectron2.evaluation.evaluator INFO: Inference done 341/1276. Dataloading: 0.0026 s/iter. Inference: 0.0957 s/iter. Eval: 0.0089 s/iter. Total: 0.1072 s/iter. ETA=0:01:40
[10/20 16:56:56] detectron2.evaluation.evaluator INFO: Inference done 388/1276. Dataloading: 0.0026 s/iter. Inference: 0.0956 s/iter. Eval: 0.0089 s/iter. Total: 0.1071 s/iter. ETA=0:01:35
[10/20 16:57:01] detectron2.evaluation.evaluator INFO: Inference done 436/1276. Dataloading: 0.0026 s/iter. Inference: 0.0954 s/iter. Eval: 0.0089 s/iter. Total: 0.1069 s/iter. ETA=0:01:29
[10/20 16:57:06] detectron2.evaluation.evaluator INFO: Inference done 484/1276. Dataloading: 0.0025 s/iter. Inference: 0.0953 s/iter. Eval: 0.0088 s/iter. Total: 0.1067 s/iter. ETA=0:01:24
[10/20 16:57:11] detectron2.evaluation.evaluator INFO: Inference done 531/1276. Dataloading: 0.0026 s/iter. Inference: 0.0954 s/iter. Eval: 0.0088 s/iter. Total: 0.1068 s/iter. ETA=0:01:19
[10/20 16:57:16] detectron2.evaluation.evaluator INFO: Inference done 579/1276. Dataloading: 0.0026 s/iter. Inference: 0.0953 s/iter. Eval: 0.0088 s/iter. Total: 0.1067 s/iter. ETA=0:01:14
[10/20 16:57:21] detectron2.evaluation.evaluator INFO: Inference done 627/1276. Dataloading: 0.0026 s/iter. Inference: 0.0952 s/iter. Eval: 0.0088 s/iter. Total: 0.1066 s/iter. ETA=0:01:09
[10/20 16:57:26] detectron2.evaluation.evaluator INFO: Inference done 675/1276. Dataloading: 0.0026 s/iter. Inference: 0.0951 s/iter. Eval: 0.0088 s/iter. Total: 0.1065 s/iter. ETA=0:01:04
[10/20 16:57:31] detectron2.evaluation.evaluator INFO: Inference done 723/1276. Dataloading: 0.0026 s/iter. Inference: 0.0950 s/iter. Eval: 0.0088 s/iter. Total: 0.1064 s/iter. ETA=0:00:58
[10/20 16:57:37] detectron2.evaluation.evaluator INFO: Inference done 771/1276. Dataloading: 0.0026 s/iter. Inference: 0.0949 s/iter. Eval: 0.0088 s/iter. Total: 0.1064 s/iter. ETA=0:00:53
[10/20 16:57:42] detectron2.evaluation.evaluator INFO: Inference done 819/1276. Dataloading: 0.0026 s/iter. Inference: 0.0949 s/iter. Eval: 0.0088 s/iter. Total: 0.1063 s/iter. ETA=0:00:48
[10/20 16:57:47] detectron2.evaluation.evaluator INFO: Inference done 867/1276. Dataloading: 0.0026 s/iter. Inference: 0.0949 s/iter. Eval: 0.0088 s/iter. Total: 0.1064 s/iter. ETA=0:00:43
[10/20 16:57:52] detectron2.evaluation.evaluator INFO: Inference done 915/1276. Dataloading: 0.0026 s/iter. Inference: 0.0949 s/iter. Eval: 0.0089 s/iter. Total: 0.1063 s/iter. ETA=0:00:38
[10/20 16:57:57] detectron2.evaluation.evaluator INFO: Inference done 963/1276. Dataloading: 0.0026 s/iter. Inference: 0.0948 s/iter. Eval: 0.0088 s/iter. Total: 0.1063 s/iter. ETA=0:00:33
[10/20 16:58:02] detectron2.evaluation.evaluator INFO: Inference done 1011/1276. Dataloading: 0.0026 s/iter. Inference: 0.0948 s/iter. Eval: 0.0088 s/iter. Total: 0.1062 s/iter. ETA=0:00:28
[10/20 16:58:07] detectron2.evaluation.evaluator INFO: Inference done 1059/1276. Dataloading: 0.0026 s/iter. Inference: 0.0948 s/iter. Eval: 0.0088 s/iter. Total: 0.1062 s/iter. ETA=0:00:23
[10/20 16:58:12] detectron2.evaluation.evaluator INFO: Inference done 1106/1276. Dataloading: 0.0026 s/iter. Inference: 0.0949 s/iter. Eval: 0.0088 s/iter. Total: 0.1063 s/iter. ETA=0:00:18
[10/20 16:58:17] detectron2.evaluation.evaluator INFO: Inference done 1153/1276. Dataloading: 0.0026 s/iter. Inference: 0.0949 s/iter. Eval: 0.0088 s/iter. Total: 0.1063 s/iter. ETA=0:00:13
[10/20 16:58:22] detectron2.evaluation.evaluator INFO: Inference done 1199/1276. Dataloading: 0.0026 s/iter. Inference: 0.0950 s/iter. Eval: 0.0088 s/iter. Total: 0.1064 s/iter. ETA=0:00:08
[10/20 16:58:27] detectron2.evaluation.evaluator INFO: Inference done 1247/1276. Dataloading: 0.0026 s/iter. Inference: 0.0950 s/iter. Eval: 0.0088 s/iter. Total: 0.1064 s/iter. ETA=0:00:03
[10/20 16:58:31] detectron2.evaluation.evaluator INFO: Total inference time: 0:02:16.327120 (0.107260 s / iter per device, on 4 devices)
[10/20 16:58:31] detectron2.evaluation.evaluator INFO: Total inference pure compute time: 0:02:00 (0.095003 s / iter per device, on 4 devices)
[10/20 16:58:46] detectron2.data.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[10/20 16:58:46] detectron2.data.common INFO: Serializing the dataset using: <class 'detectron2.data.common._TorchSerializedList'>
[10/20 16:58:46] detectron2.data.common INFO: Serializing 2000 elements to byte tensors and concatenating them all ...
[10/20 16:58:46] detectron2.data.common INFO: Serialized dataset takes 15.18 MiB
[10/20 16:58:46] detectron2.evaluation.evaluator INFO: Start inference on 500 batches
[10/20 16:59:00] detectron2.evaluation.evaluator INFO: Inference done 1/500. Dataloading: 6.9918 s/iter. Inference: 7.5235 s/iter. Eval: 0.0224 s/iter. Total: 14.5403 s/iter. ETA=2:00:55
[10/20 16:59:05] detectron2.evaluation.evaluator INFO: Inference done 44/500. Dataloading: 0.0026 s/iter. Inference: 0.0978 s/iter. Eval: 0.0166 s/iter. Total: 0.1169 s/iter. ETA=0:00:53
[10/20 16:59:11] detectron2.evaluation.evaluator INFO: Inference done 91/500. Dataloading: 0.0026 s/iter. Inference: 0.0939 s/iter. Eval: 0.0157 s/iter. Total: 0.1122 s/iter. ETA=0:00:45
[10/20 16:59:16] detectron2.evaluation.evaluator INFO: Inference done 138/500. Dataloading: 0.0026 s/iter. Inference: 0.0935 s/iter. Eval: 0.0141 s/iter. Total: 0.1103 s/iter. ETA=0:00:39
[10/20 16:59:21] detectron2.evaluation.evaluator INFO: Inference done 181/500. Dataloading: 0.0026 s/iter. Inference: 0.0963 s/iter. Eval: 0.0134 s/iter. Total: 0.1124 s/iter. ETA=0:00:35
[10/20 16:59:26] detectron2.evaluation.evaluator INFO: Inference done 227/500. Dataloading: 0.0027 s/iter. Inference: 0.0961 s/iter. Eval: 0.0130 s/iter. Total: 0.1119 s/iter. ETA=0:00:30
[10/20 16:59:31] detectron2.evaluation.evaluator INFO: Inference done 278/500. Dataloading: 0.0027 s/iter. Inference: 0.0945 s/iter. Eval: 0.0123 s/iter. Total: 0.1096 s/iter. ETA=0:00:24
[10/20 16:59:36] detectron2.evaluation.evaluator INFO: Inference done 323/500. Dataloading: 0.0027 s/iter. Inference: 0.0943 s/iter. Eval: 0.0130 s/iter. Total: 0.1100 s/iter. ETA=0:00:19
[10/20 16:59:41] detectron2.evaluation.evaluator INFO: Inference done 371/500. Dataloading: 0.0027 s/iter. Inference: 0.0935 s/iter. Eval: 0.0131 s/iter. Total: 0.1093 s/iter. ETA=0:00:14
[10/20 16:59:46] detectron2.evaluation.evaluator INFO: Inference done 420/500. Dataloading: 0.0027 s/iter. Inference: 0.0932 s/iter. Eval: 0.0127 s/iter. Total: 0.1086 s/iter. ETA=0:00:08
[10/20 16:59:51] detectron2.evaluation.evaluator INFO: Inference done 467/500. Dataloading: 0.0027 s/iter. Inference: 0.0932 s/iter. Eval: 0.0127 s/iter. Total: 0.1086 s/iter. ETA=0:00:03
[10/20 16:59:56] detectron2.evaluation.evaluator INFO: Total inference time: 0:00:54.771263 (0.110649 s / iter per device, on 4 devices)
[10/20 16:59:56] detectron2.evaluation.evaluator INFO: Total inference pure compute time: 0:00:45 (0.092820 s / iter per device, on 4 devices)
[10/28 11:21:56] detectron2 INFO: Rank of current process: 1. World size: 3
[10/28 11:21:56] detectron2 INFO: Environment info:
-------------------------------  ------------------------------------------------------------------------
sys.platform                     linux
Python                           3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
numpy                            1.22.4
detectron2                       0.6 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/detectron2
Compiler                         GCC 9.4
CUDA compiler                    CUDA 11.8
detectron2 arch flags            8.6
DETECTRON2_ENV_MODULE            <not set>
PyTorch                          2.4.1 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/torch
PyTorch debug build              False
torch._C._GLIBCXX_USE_CXX11_ABI  False
GPU available                    Yes
GPU 0,1,2                        NVIDIA GeForce RTX 3090 (arch=8.6)
Driver version                   550.144.03
CUDA_HOME                        /data/hmp/CUDA/11.8
Pillow                           9.3.0
torchvision                      0.20.0 @/data/hmp/conda_envs/AAA/lib/python3.8/site-packages/torchvision
torchvision arch flags           3.5, 5.0, 6.0, 7.0, 7.5, 8.0, 8.6
fvcore                           0.1.5.post20221221
iopath                           0.1.9
cv2                              4.12.0
-------------------------------  ------------------------------------------------------------------------
PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 11.8
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_90,code=sm_90;-gencode;arch=compute_37,code=compute_37
  - CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.8, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

[10/28 11:21:56] detectron2 INFO: Command line arguments: Namespace(config_file='configs/semantic/eval_PE.yaml', dist_url='tcp://127.0.0.1:50185', eval_only=True, machine_rank=0, num_gpus=3, num_machines=1, opts=[], resume=False)
[10/28 11:21:56] detectron2 INFO: Contents of args.config_file=configs/semantic/eval_PE.yaml:
# python train_net.py --config-file configs/semantic/eval.yaml  --num-gpus 8 --eval-only

_BASE_: ./train_semantic_large.yaml
MODEL:
  BACKBONE:
    NAME: "PEEncoder"
  META_ARCHITECTURE: "MAFT_Plus"


DATASETS:
  # TEST: ("openvocab_pascal20_sem_seg_val", "openvocab_ade20k_full_sem_seg_val", 'openvocab_pascal_ctx459_sem_seg_val', 'openvocab_pascal_ctx59_sem_seg_val', 'openvocab_ade20k_panoptic_val') 
  TEST: ( 'openvocab_ade20k_panoptic_val',)

OUTPUT_DIR: ./out/semantic/evaluation

PE:
  ENABLED: True
  MODEL_NAME: "PE-Core-L14-336"
